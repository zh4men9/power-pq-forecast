2025-10-27 09:52:09 | INFO | 日志系统已初始化
2025-10-27 09:52:09 | INFO | 日志文件: outputs/output-2025-10-27-0952/logs/training.log
2025-10-27 09:52:09 | INFO | ============================================================
2025-10-27 09:52:09 | INFO | 步骤 1/7: 加载配置文件
2025-10-27 09:52:09 | INFO | ============================================================
2025-10-27 09:52:09 | INFO | 配置文件加载成功: config_p_only_newdata-transformer89.yaml
2025-10-27 09:52:09 | INFO | 输出目录: outputs/output-2025-10-27-0952
2025-10-27 09:52:09 | INFO | 🔢 设置随机种子: 42
2025-10-27 09:52:09 | INFO |    ✓ PyTorch种子已设置
2025-10-27 09:52:09 | INFO |    ✓ 所有随机种子已设置为: 42
2025-10-27 09:52:09 | INFO | ✓ 配置文件已备份至: outputs/output-2025-10-27-0952/config_used.yaml
2025-10-27 09:52:09 | INFO | 
2025-10-27 09:52:09 | INFO | 使用数据文件: data/raw2/复制数据.xlsx
2025-10-27 09:52:09 | INFO | 
2025-10-27 09:52:09 | INFO | ============================================================
2025-10-27 09:52:09 | INFO | 🔄 多策略模式: 将依次运行 1 个填充策略
2025-10-27 09:52:09 | INFO | 策略列表: nearest_p
2025-10-27 09:52:09 | INFO | ============================================================
2025-10-27 09:52:09 | INFO | 
2025-10-27 09:52:09 | INFO | 
2025-10-27 09:52:09 | INFO | ████████████████████████████████████████████████████████████
2025-10-27 09:52:09 | INFO | 运行策略 [1/1]: nearest_p
2025-10-27 09:52:09 | INFO | ████████████████████████████████████████████████████████████
2025-10-27 09:52:09 | INFO | 
2025-10-27 09:52:09 | INFO | ============================================================
2025-10-27 09:52:09 | INFO | 步骤 2/7: 加载数据 (填充策略: nearest_p)
2025-10-27 09:52:09 | INFO | ============================================================
2025-10-27 09:52:09 | INFO | 
2025-10-27 09:52:09 | INFO | ============================================================
2025-10-27 09:52:09 | INFO | 步骤 3/7: 模型训练与评估
2025-10-27 09:52:09 | INFO | ============================================================
2025-10-27 09:52:10 | INFO | 
============================================================
2025-10-27 09:52:10 | INFO | 步骤 3.1: 训练深度学习模型 (一次性训练，所有步长共享)
2025-10-27 09:52:10 | INFO | ============================================================
2025-10-27 09:52:10 | INFO | 🔧 训练深度学习模型 (将在所有1个预测步长上评估)...
2025-10-27 09:52:10 | INFO | 
============================================================
2025-10-27 09:52:10 | INFO | 直接策略 (Direct Strategy)
2025-10-27 09:52:10 | INFO | ============================================================
2025-10-27 09:52:10 | INFO |   将为每个预测步长训练独立模型
2025-10-27 09:52:10 | INFO |   预测步长: [1] (1 个)
2025-10-27 09:52:10 | INFO |   每个算法将训练 1 次
2025-10-27 09:52:10 | INFO | ============================================================

2025-10-27 09:52:10 | INFO | 准备 horizon=1 的序列数据...
2025-10-27 09:52:10 | INFO | 
初始化 LSTM 模型参数:
2025-10-27 09:52:10 | INFO |   hidden_size=128
2025-10-27 09:52:10 | INFO |   num_layers=3
2025-10-27 09:52:10 | INFO |   dropout=0.12
2025-10-27 09:52:10 | INFO |   epochs=500
2025-10-27 09:52:10 | INFO |   batch_size=64
2025-10-27 09:52:10 | INFO |   learning_rate=0.00013
2025-10-27 09:52:10 | INFO | 
初始化 Transformer 模型参数:
2025-10-27 09:52:10 | INFO |   d_model=256
2025-10-27 09:52:10 | INFO |   nhead=16
2025-10-27 09:52:10 | INFO |   num_encoder_layers=4
2025-10-27 09:52:10 | INFO |   num_decoder_layers=6
2025-10-27 09:52:10 | INFO |   dim_feedforward=128
2025-10-27 09:52:10 | INFO |   dropout=0.12344460274517984
2025-10-27 09:52:10 | INFO |   epochs=500
2025-10-27 09:52:10 | INFO |   batch_size=64
2025-10-27 09:52:10 | INFO |   learning_rate=0.0001290786682817798
2025-10-27 09:52:10 | INFO | 
📊 评估 horizon=1:
2025-10-27 09:52:10 | INFO |   序列长度: 24
2025-10-27 09:52:10 | INFO |   预测步长: 1
2025-10-27 09:52:10 | INFO |   预测目标: ['P']
2025-10-27 09:52:10 | INFO |   外生变量: ['定子电流', '定子电压', '转子电压', '转子电流', '励磁电流']
2025-10-27 09:52:10 | INFO |   Fold 1/1 - Horizon 1
2025-10-27 09:52:10 | INFO |     训练集: 3160 样本, 测试集: 200 样本
2025-10-27 09:52:10 | INFO |     训练 LSTM (horizon=1, fold=1)...
2025-10-27 09:52:10 | INFO | ✓ 使用 CPU (配置指定)
2025-10-27 09:52:10 | INFO |       [1/6] 准备数据 (X shape: (3160, 24, 7), y shape: (3160, 1))...
2025-10-27 09:52:10 | INFO |       准备数据: X shape=(3160, 24, 7), device=cpu
2025-10-27 09:52:10 | INFO |       计算归一化参数...
2025-10-27 09:52:10 | INFO |       归一化均值: [3.93233018e+02 6.50867484e+00 1.19842819e+04 1.83869702e+01
 2.12478660e+02 2.40140473e+03 8.60262889e+01]
2025-10-27 09:52:10 | INFO |       归一化标准差: [1.65135715e+02 7.25439543e+01 4.87952754e+03 4.12218170e+00
 7.41616192e+01 8.06400850e+02 2.88092235e+01]
2025-10-27 09:52:10 | INFO |       应用归一化...
2025-10-27 09:52:10 | INFO |       归一化后数据范围: [-4.4595, 3.5614]
2025-10-27 09:52:10 | INFO |       转换为Tensor (保持在CPU)...
2025-10-27 09:52:10 | INFO |       X Tensor范围: [-4.4595, 3.5614]
2025-10-27 09:52:10 | INFO |       X Tensor创建完成 (CPU)
2025-10-27 09:52:10 | INFO |       处理y数据: shape=(3160, 1)
2025-10-27 09:52:10 | INFO |       y数据范围: [0.0432, 606.8093]
2025-10-27 09:52:10 | INFO |       y Tensor创建完成 (CPU)
2025-10-27 09:52:10 | INFO |       [2/6] 确定模型维度...
2025-10-27 09:52:10 | INFO |       模型配置: n_horizons=1, output_size=1 (total=1)
2025-10-27 09:52:10 | INFO |       [3/6] 创建LSTM模型 (input=7, hidden=128, output=1, horizons=1)...
2025-10-27 09:52:10 | INFO |       [4/6] 模型已创建并移至设备: cpu
2025-10-27 09:52:10 | INFO |       [5/6] 创建数据加载器 (batch_size=64)...
2025-10-27 09:52:10 | INFO |       数据加载器创建完成: 50 个批次
2025-10-27 09:52:10 | INFO |       [6/6] 开始训练 (500 epochs, lr=0.00013)...
2025-10-27 09:52:10 | INFO |       🔍 第一个批次调试:
2025-10-27 09:52:10 | INFO |          batch_X shape: torch.Size([64, 24, 7])
2025-10-27 09:52:10 | INFO |          batch_X 范围: [-4.4595, 3.4318]
2025-10-27 09:52:10 | INFO |          batch_X 是否有NaN: False
2025-10-27 09:52:10 | INFO |          batch_y shape: torch.Size([64, 1])
2025-10-27 09:52:10 | INFO |          batch_y 范围: [0.0522, 603.3972]
2025-10-27 09:52:10 | INFO |          batch_y 是否有NaN: False
2025-10-27 09:52:10 | INFO |          模型输出 shape: torch.Size([64, 1])
2025-10-27 09:52:10 | INFO |          模型输出 范围: [0.0658, 0.0937]
2025-10-27 09:52:10 | INFO |          模型输出 是否有NaN: False
2025-10-27 09:52:10 | INFO |          Loss值: 160416.890625
2025-10-27 09:52:10 | INFO |          Loss是否为NaN: False
2025-10-27 10:00:16 | INFO |       ✓ LSTM训练完成，用时: 485.8秒 (8.1分钟)
2025-10-27 10:00:16 | INFO |       准备数据: X shape=(200, 24, 7), device=cpu
2025-10-27 10:00:16 | INFO |       应用归一化...
2025-10-27 10:00:16 | INFO |       归一化后数据范围: [-1.4062, 2.8454]
2025-10-27 10:00:16 | INFO |       转换为Tensor (保持在CPU)...
2025-10-27 10:00:16 | INFO |       X Tensor范围: [-1.4062, 2.8454]
2025-10-27 10:00:16 | INFO |       X Tensor创建完成 (CPU)
2025-10-27 10:00:16 | INFO |       LSTM (P): RMSE=87.9274, MAE=59.8447
2025-10-27 10:00:16 | INFO |     训练 Transformer (horizon=1, fold=1)...
2025-10-27 10:00:16 | INFO | ✓ 使用 CPU (配置指定)
2025-10-27 10:00:16 | INFO |       准备数据: X shape=(3160, 24, 7), device=cpu
2025-10-27 10:00:16 | INFO |       计算归一化参数...
2025-10-27 10:00:16 | INFO |       应用归一化...
2025-10-27 10:00:16 | INFO |       转换为Tensor (保持在CPU)...
2025-10-27 10:00:16 | INFO |       X Tensor创建完成 (CPU)
2025-10-27 10:00:16 | INFO |       处理y数据: shape=(3160, 1)
2025-10-27 10:00:16 | INFO |       y Tensor创建完成 (CPU)
2025-10-27 10:00:16 | INFO |       模型配置: n_horizons=1, output_size=1 (total=1)
2025-10-27 10:00:16 | INFO |       模型已创建并移至设备: cpu
2025-10-27 10:00:16 | INFO |       模型参数设备: cpu
2025-10-27 10:00:16 | INFO |       数据加载器创建完成: 50 个批次
2025-10-27 10:00:16 | INFO |       开始训练 Transformer (500 epochs, lr=0.0001290786682817798)...
2025-10-27 11:15:15 | INFO | ✓ Transformer训练完成，用时: 4498.6秒 (75.0分钟)
2025-10-27 11:15:15 | INFO |       准备数据: X shape=(200, 24, 7), device=cpu
2025-10-27 11:15:15 | INFO |       应用归一化...
2025-10-27 11:15:15 | INFO |       转换为Tensor (保持在CPU)...
2025-10-27 11:15:15 | INFO |       X Tensor创建完成 (CPU)
2025-10-27 11:15:15 | INFO |       Transformer (P): RMSE=26.6061, MAE=18.8847
2025-10-27 11:15:15 | INFO | ✓ 深度学习模型训练完成
2025-10-27 11:15:15 | INFO | 
2025-10-27 11:15:15 | INFO | 
============================================================
2025-10-27 11:15:15 | INFO | 步骤 3.2: 评估预测步长 = 1
2025-10-27 11:15:15 | INFO | ============================================================
2025-10-27 11:15:15 | INFO | 交叉验证配置: 1 折, 测试窗口大小=200
2025-10-27 11:15:15 | INFO | 
[1/3] 评估基线模型...
2025-10-27 11:15:15 | INFO |   Fold 1/1 - Baseline models
2025-10-27 11:15:15 | INFO |     训练集大小: 3015 样本, 测试集大小: 200 样本
2025-10-27 11:15:15 | INFO |     训练 Naive 基线模型...
2025-10-27 11:15:15 | INFO |       Naive (P): RMSE=154.1857, MAE=110.6505, ACC=0.00%
2025-10-27 11:15:15 | INFO |     训练 SeasonalNaive 基线模型 (周期长度: 24)...
2025-10-27 11:15:15 | INFO |       SeasonalNaive (P): RMSE=190.3171, MAE=153.2919, ACC=0.00%
2025-10-27 11:15:15 | INFO | ✓ 基线模型评估完成 (2 个结果)
2025-10-27 11:15:15 | INFO | 
[2/3] 评估树模型...
2025-10-27 11:15:15 | INFO |   Fold 1/1 - Tree models
2025-10-27 11:15:15 | INFO |     训练集大小: 3015 样本, 测试集大小: 200 样本
2025-10-27 11:15:15 | INFO |     训练 RandomForest 模型 (特征维度: 1322)...
2025-10-27 11:15:16 | INFO |       RandomForest 训练完成，开始预测...
2025-10-27 11:15:16 | INFO |       RandomForest (P): RMSE=65.1804, MAE=45.2735
2025-10-27 11:15:16 | INFO |     训练 XGBoost 模型 (特征维度: 1322)...
2025-10-27 11:15:16 | INFO |       XGBoost 训练完成，开始预测...
2025-10-27 11:15:16 | INFO |       XGBoost (P): RMSE=61.7511, MAE=44.6524
2025-10-27 11:15:16 | INFO | ✓ 树模型评估完成 (2 个结果)
2025-10-27 11:15:16 | INFO | 
[3/3] 添加深度学习模型结果...
2025-10-27 11:15:16 | INFO | ✓ 深度学习模型结果已添加 (2 个结果)
2025-10-27 11:15:16 | INFO | 
2025-10-27 11:15:16 | INFO | ============================================================
2025-10-27 11:15:16 | INFO | 步骤 4/7: 保存训练好的模型
2025-10-27 11:15:16 | INFO | ============================================================
2025-10-27 11:15:16 | INFO | ✓ 模型已保存: outputs/output-2025-10-27-0952/models_nearest_p/LSTM_h1.pkl
2025-10-27 11:15:16 | INFO | ✓ 模型已保存: outputs/output-2025-10-27-0952/models_nearest_p/Transformer_h1.pkl
2025-10-27 11:15:16 | INFO | ✓ 所有模型已保存至: outputs/output-2025-10-27-0952/models_nearest_p
2025-10-27 11:15:16 | INFO | 
2025-10-27 11:15:16 | INFO | ============================================================
2025-10-27 11:15:16 | INFO | 步骤 5/7: 生成未来预测
2025-10-27 11:15:16 | INFO | ============================================================
2025-10-27 11:15:16 | INFO | 最优模型（基于RMSE）: Transformer
2025-10-27 11:15:16 | INFO | 使用模型进行预测: Transformer
2025-10-27 11:15:16 | WARNING | ⚠️  模型 Transformer 不可用，跳过预测
2025-10-27 11:15:16 | INFO |    可用的模型键: ['LSTM_h1', 'Transformer_h1']
2025-10-27 11:15:16 | INFO | 
2025-10-27 11:15:16 | INFO | ============================================================
2025-10-27 11:15:16 | INFO | 步骤 6/7: 生成图表
2025-10-27 11:15:16 | INFO | ============================================================
2025-10-27 11:15:17 | INFO | 
2025-10-27 11:15:17 | INFO | ============================================================
2025-10-27 11:15:17 | INFO | 步骤 7/7: 生成报告 (策略: nearest_p)
2025-10-27 11:15:17 | INFO | ============================================================
2025-10-27 11:15:17 | INFO | ✓ Word报告已生成: outputs/output-2025-10-27-0952/report/项目评估报告_nearest_p.docx
2025-10-27 11:15:17 | INFO | 
2025-10-27 11:15:17 | INFO | ============================================================
2025-10-27 11:15:17 | INFO | ✓ 所有策略运行完成! 共生成 1/1 个报告
2025-10-27 11:15:17 | INFO | 成功的策略: nearest_p
2025-10-27 11:15:17 | INFO | ============================================================
2025-10-27 11:15:17 | INFO | ============================================================
2025-10-27 11:15:17 | INFO | 运行完成!
2025-10-27 11:15:17 | INFO | ============================================================
2025-10-27 11:15:17 | INFO | 本次运行输出目录: outputs/output-2025-10-27-0952
2025-10-27 11:15:17 | INFO | 最新结果链接: outputs/latest
2025-10-27 11:15:17 | INFO |   - 日志文件: outputs/output-2025-10-27-0952/logs/training.log
2025-10-27 11:15:17 | INFO |   - 报告目录: outputs/output-2025-10-27-0952/report (实际生成 1/1 个报告)
2025-10-27 11:15:17 | INFO | ============================================================
